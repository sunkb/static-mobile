(window.webpackJsonp=window.webpackJsonp||[]).push([[28,21],{188:function(t,e,n){"use strict";n.d(e,"a",function(){return o});n(108);var o=function(t){var video=t,e=document;/Android|webOS|iPhone|iPad|BlackBerry|iPod/i.test(navigator.userAgent)?void 0!==video.play()&&(video.play(),"ipad"==navigator.userAgent.toLowerCase().match(/iPad/i)&&(video.addEventListener("play",function(){var t,e=(t=video).webkitEnterFullScreen?"webkitEnterFullScreen":!!t.webkitRequestFullScreen&&"webkitRequestFullScreen";video[e]()}),video.addEventListener("webkitfullscreenchange",function(t){e.webkitIsFullScreen||video.pause()},!1),video.addEventListener("fullscreenchange ",function(t){e.webkitIsFullScreen||video.pause()},!1),video.addEventListener("ended",function(){this.webkitExitFullScreen()},!1))):(video.requestFullscreen(),video.play())}},189:function(t,e){},191:function(t,e,n){t.exports=n.p+"img/6446c2c.png"},251:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAUCAYAAAC07qxWAAAAAXNSR0IArs4c6QAAAYhJREFUKBWNkr9Lw1AQx5tflmxCXCKOzqLQqaBg0aRJGxxEEPwXBP8NFxcnERwcXBybtMYKtqJmCoKrkyjGwYBoCzahsX6vtCXRtnjwcpfv+7x79+69VKlU2k39w1iGYXYsyzrodDrsOJ6FqYA2AZ+4riuMghmaKJfL81EU2cjuSpK0kc1mv34v6IIk2rY9G4bhBcInnucNXdc/4/AAJLFarU4HQXCOMMDIG4bhk06WOICiKB62X4IeYlxXKpUZgsgSIAnFYvEdbgUHfETdN1QS6YmtSegbdcDzvGP85wRBUEaCtIB6i7btw2/92bqfkTzq/YZ7gZ/g4hPxGFmYTCazB7+NdmlDt67Vanyz2TwClEc2BW265+NZKHYcR/R9/xTAHMdxi4VC4YH0REZkmmw0Ghb0qXQ6vaqq6jNBZIMa0S+51WpdkoaacpqmvXaJ3qd76t4930L7EEVxGff8FocoZnBNC+12+ww13eHlrA97OQSyuKY6/JUsy2ujIAJTpmkeog1jG0/cD4cAmT4DCe2kAAAAAElFTkSuQmCC"},252:function(t,e,n){var content=n(406);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(39).default)("74c5f603",content,!0,{sourceMap:!1})},394:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAAXNSR0IArs4c6QAAAg9JREFUaAXtmr9OwlAUh9sig5PECBOTK0vZ3E3cXFzcXVzgAZx1Y8T4ACaGwTi4GF9AWfgTBt7AwahxYIFE2vo7CSTkpDRV7K2cni69p5R77ne+0yaXYHe73WPLsppBEBRxTup4yeVytWq1ep9UgrjzOgC9TBiW1lL2PK/V7/fduAtL6j4HE+8kNTmbdxPQd4AusOtGQwI2eez6vn+NjrJNJl3MZRrYAuxhr9c7W1yEybFx4BncOaD3TYLOc6UCDMv0smwNBoPyfCGmzqkAExyAi9Pp9LbT6eRNwVKe1IApOaD3bNtu0tjUYaPCgalkEXkeAP6MAvgR96z0Eeb/wPw3/wV4JZi4Xwb0Y6otHXehf3jfQaaA0dJOpoCpUzIHvLHs+cAD/uY4zpHrum2ME3t7Lsv/2+vD4XB7Mpk00L4nYXNEGb7C/vVpnWAJsFKpfJZKpRqGXz8FNrVtDFvXStdGo9EWRIV2b+hFyoaWOMWvIa8YttHaa9PS2HMXxuMx7cZCt6BLgfGFPKAvcLYwCZ1EHFHPsAhADqHAvCLSYjUszSjnUcO8ItJiNSzNKOdRw7wi0mI1LM0o51HDvCLSYjUszSjnUcO8ItJiNSzNKOdRw7wi0mI1LM0o51HDvCLSYjUszSjnUcO8ItJiNSzNKOdRw7wi0mI1LM0o58meYfyB651XQWpMrGS4ngXoGWP9G0Vnh6+nvMDOAAAAAElFTkSuQmCC"},395:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAAXNSR0IArs4c6QAAAnZJREFUaAXtmr1KA0EUhbO7WNhZaGU605sEBUtRsLOWvIPptfURxCcQJIVY2IhNwMpq89dbaqWPkOx6D7gwhCRuZu7cGdhZCDvozrnnu2fcnZhEg8HgIs/zu1qttk0vW8dnkiSXrVbr2VaBsrqxACy81GezWW84HO6XNWbrupiEbSar+t7MsuxpNBptqT+UHgNY8tgj6HtaVZFkUbWWNHCNYM9paV+rJiTH4sCAI+gbgj6VBC1qOQGm4glB9yaTSb0wInV2BYyUd6bT6WOaphtSsKjjDBjFCfqITrcYSx0RdTiXKraizksURe/UgGzFNUa/Iv0f0n/wBdgIpuxkgn51uqTLGmW87qxSwLSk40oBY6UEYMa/Fy+lQsJexsJoKiTM2EwvpULCXsbCaCokzNhML6VCwiaxxHF8Ra9Dehv2YaKDudCAFjRNtdT53An32+12Sp8yHJtAYy40oEVm+6ph0zErML396o3H491ms/mlC13AQgNa0DSFVOdzAzfoI5U3Xeh5WGgRcEM1bDpmBYYZGNSBloCFP3ZgHWgpWGvA60BLwloFLgMtDWsdeBW0C1gR4GXQeGwVjx4bd2PUXXSI/iNeTRVm8PiShEVNK3dpCPt6iAGr6SJZ3c2JaSNFgOdhsYx1NiemsJhvHXgRLHZjujsyU2irwMtgC9MuoK0B/wfrCtoKcFlYF9DswOvCSkOzAuvCSkJzA3dMt4vzNzJqYqdoCMeZFZjMntAXzg5Mt4sFNLQIkvULbKJ7aY6ETDVYEzY1IzE/AEt02WWNkLDL7kvUDglLdNlljZCwy+5L1K5ewrQ5/5borA81wIqEu1WA/mPs/gJ/XAadc7UYlQAAAABJRU5ErkJggg=="},396:function(t,e,n){t.exports=n.p+"img/88250a2.png"},405:function(t,e,n){"use strict";var o=n(252);n.n(o).a},406:function(t,e,n){e=t.exports=n(38)(!1);var o=n(180)(n(191));e.push([t.i,".top-step-bar[data-v-5f385024] {\n  padding-top: 0.26667rem;\n  margin-bottom: 0.26667rem;\n  height: 2.2rem;\n}\n.page-content[data-v-5f385024] {\n  padding: 0 0.4rem;\n}\n.page-content-content[data-v-5f385024] {\n    display: flex;\n    flex-direction: column;\n    justify-content: space-between;\n    height: 73vh;\n}\n.signup-title[data-v-5f385024] {\n  font-size: 0.4rem;\n  color: #333333;\n  font-weight: bold;\n  margin-bottom: 0.4rem;\n}\n.signup-title2[data-v-5f385024] {\n  font-size: 0.37333rem;\n  color: #333333;\n  margin-bottom: 0.26667rem;\n}\n#step3[data-v-5f385024] {\n  width: 100vw;\n  height: 100vh;\n  background: #fff;\n}\n.title[data-v-5f385024] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding-right: 0.3rem;\n}\n.title-action-text[data-v-5f385024] {\n    color: #16C8D2;\n    display: inline-block;\n    font-size: 0.34667rem;\n    margin-bottom: 0.4rem;\n}\n.title-action-img[data-v-5f385024] {\n    width: 0.13333rem;\n}\n.topic-text[data-v-5f385024] {\n  margin-top: -0.1rem;\n  width: 9rem;\n}\n.topic-text-eng[data-v-5f385024] {\n    font-size: 0.34667rem;\n    color: #333333;\n    letter-spacing: 0;\n    margin-bottom: 0.18667rem;\n}\n.topic-text-chn[data-v-5f385024] {\n    font-size: 0.32rem;\n    color: #B2B2B2;\n    letter-spacing: 0;\n}\n.video[data-v-5f385024] {\n  text-align: center;\n  margin-top: 0.4rem;\n  display: flex;\n  justify-content: center;\n  position: relative;\n}\n.video-hint[data-v-5f385024] {\n    width: 7.04rem;\n    height: 3.96rem;\n    display: flex;\n    flex-flow: column;\n    justify-content: center;\n    align-items: center;\n    background: #FAFAFA;\n    border: 1px dashed #E6E6E6;\n}\n.video-hint-progresstext[data-v-5f385024] {\n      font-size: 0.34667rem;\n      color: #B2B2B2;\n      margin-top: 0.26667rem;\n}\n.video-hint-hint[data-v-5f385024] {\n      width: 2.6rem;\n      color: #B2B2B2;\n      font-size: 0.32rem;\n      margin-top: 0.2rem;\n}\n.video-hint-hintimg[data-v-5f385024] {\n      width: 0.66667rem;\n      height: 0.66667rem;\n}\n.video-hint-progress[data-v-5f385024] {\n      position: relative;\n      width: 4.66667rem;\n      height: 0.13333rem;\n      margin-bottom: 0.3rem;\n}\n.video-hint-progress-bg[data-v-5f385024] {\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: #E6E6E6;\n        border-radius: 0.1rem;\n}\n.video-hint-progress-fg[data-v-5f385024] {\n        position: absolute;\n        top: 0;\n        left: 0;\n        height: 100%;\n        background: #16C8D2;\n        border-radius: 0.1rem;\n}\n.video-uploaded-video[data-v-5f385024] {\n    width: 7.04rem;\n    height: 3.96rem;\n    overflow: hidden;\n    position: relative;\n    background: #E6E6E6;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n}\n.video-uploaded-video-play[data-v-5f385024] {\n      position: absolute;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      width: 1.01333rem;\n      height: 1.01333rem;\n      background: url("+o+") 50% 50%/contain no-repeat;\n}\n.video-uploaded-video-img[data-v-5f385024] {\n      height: 3.96rem;\n}\n.video-upload[data-v-5f385024] {\n    position: absolute;\n    left: 50%;\n    bottom: 0;\n    transform: translate(-50%, 50%);\n}\n.video-upload-action[data-v-5f385024] {\n      width: 1.06667rem;\n      height: 1.06667rem;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      background: #fff;\n      border-radius: 0.53333rem;\n      box-shadow: 0 0.02667rem 0.05333rem 0 #DEE6EC;\n}\n.video-upload-action-img[data-v-5f385024] {\n        width: 0.85333rem;\n        height: 0.85333rem;\n}\n",""])},417:function(t,e,n){"use strict";n.r(e);n(73),n(61),n(22),n(23),n(42),n(40);var o,r,d,c=n(5),l=n(199),v=n(193),m=(n(397),n(112),n(113),n(13),n(59),n(208)),f=n(209),h=n(181),A=n(404),S={video:{mimeType:["video/mp4","video/mpeg","video/quicktime","video/x-msvideo","video/ogg","video/webm","application/vnd.rn-realmedia-vbr"],limit:300}},w="video",C=function(){function t(){Object(m.a)(this,t)}var e;return Object(f.a)(t,[{key:"init",value:(e=Object(c.a)(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.a.get("/Mobile/StudentActivity/token");case 2:(e=t.sent).status&&(this.domain=e.data.domain,this.token=e.data.uptoken);case 4:case"end":return t.stop()}},t,this)})),function(){return e.apply(this,arguments)})},{key:"upload",value:function(t,e,n,o,r){var d=30,c={};if(e&&S[e]&&(d=S[e].limit,c.mimeType=S[e].mimeType),t.size>1024*d*1024)return{error:"上传文件不能大于".concat(d,"MB")};var l=t.name.split("."),v="".concat(E(),".").concat(l[l.length-1]),m=A.upload(t,v,this.token,c);return m.subscribe({next:n,error:o,complete:r}),{subscription:m}}}]),t}(),E=function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(t){return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)})},y=n(195),x=n(194),_=n(188),k=(n(189),{name:"Signup",mixins:[x.default],head:function(){return{title:"上传视频"}},components:{"step-bar":l.b,"submit-area":l.c,toast:y.a},data:function(){return{steps:v.STEPS,landiLevel:"",topic:null,videoStatus:{},videoSrc:"",formData:null}},computed:{videoUploaded:function(){return"uploaded"==this.videoStatus.type}},methods:{nextStep:function(){this.videoUploaded&&this.gotoPage("presentation-signup-step4")},gotoStep2:function(){this.gotoPage("presentation-signup-step2")},videoUpload:(d=Object(c.a)(regeneratorRuntime.mark(function t(){var e,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.$refs.toast.showLoadingToast(),e=new C,t.next=4,e.init();case 4:if(this.videoSrc=e.domain,n=e.upload(this.$refs.videoUploadInput.files[0],w,this.fileUploadNext,this.fileUploadError,this.fileUploadComplete),this.$refs.toast.hideLoadingToast(),!n.error){t.next=10;break}return this.$refs.toast.showToast(n.error),t.abrupt("return");case 10:this.videoStatus=v.VIDEO_STATUS_TYPE.UPLOADING;case 11:case"end":return t.stop()}},t,this)})),function(){return d.apply(this,arguments)}),fileUploadNext:function(t){this.videoStatus.progress=Math.round(100*t.total.percent)/100},fileUploadError:function(t){console.log(t),this.videoStatus=v.VIDEO_STATUS_TYPE.ERROR,this.$refs.toast.showToast(t.message)},fileUploadComplete:function(t){this.videoStatus=v.VIDEO_STATUS_TYPE.UPLOADED,this.videoSrc="".concat(this.videoSrc).concat(t.key),this.formData.videoSrc=this.videoSrc,this.formData.videoKey=t.key,localStorage.setItem(v.STROGE.FORM_DATA,JSON.stringify(this.formData)),this.$refs.toast.showToast("上传成功")},initDataFromStroge:function(){var t=JSON.parse(localStorage.getItem(v.STROGE.FORM_DATA));if(!(t&&t.landiLevel&&t.landiLevel.topics))return!1;this.landiLevel=t.landiLevel.name;var e=!0,n=!1,o=void 0;try{for(var r,d=t.landiLevel.topics[Symbol.iterator]();!(e=(r=d.next()).done);e=!0){var c=r.value;c.id==t.topicID&&(this.topic=c)}}catch(t){n=!0,o=t}finally{try{e||null==d.return||d.return()}finally{if(n)throw o}}return t.videoSrc?(this.videoSrc=t.videoSrc,this.videoStatus=v.VIDEO_STATUS_TYPE.UPLOADED):this.videoStatus=v.VIDEO_STATUS_TYPE.ADD,this.formData=t,!0},initDataFromAPI:(r=Object(c.a)(regeneratorRuntime.mark(function t(){var e,n,video,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.$refs.toast.showLoadingToast(),e=this.$route.query.activity_id,t.next=4,h.a.get("".concat(v.API.MY_WORK,"?activity_id=").concat(e));case 4:if(n=t.sent,this.$refs.toast.hideLoadingToast(),n.status){t.next=11;break}return this.$refs.toast.showToast(n.info),t.abrupt("return",!1);case 11:if(!n.data.id){t.next=22;break}return this.landiLevel=n.data.combination_name,this.topic={cn_topic_name:n.data.cn_topic_name,en_topic_name:n.data.en_topic_name},this.videoSrc=n.data.video_url,this.videoStatus=v.VIDEO_STATUS_TYPE.UPLOADED,video=n.data.video_url.split("/"),o=video[video.length-1],this.formData={landiLevel:{id:n.data.combination_id},topicID:n.data.topic_id,videoKey:o,workID:n.data.id,address:n.data.address},t.abrupt("return",!0);case 22:return t.abrupt("return",!1);case 23:case"end":return t.stop()}},t,this)})),function(){return r.apply(this,arguments)}),playFn:function(t){var e=document.getElementById(t);Object(_.a)(e)}},mounted:(o=Object(c.a)(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.initDataFromStroge()){t.next=4;break}return t.next=4,this.initDataFromAPI();case 4:localStorage.setItem(v.STROGE.FORM_DATA,JSON.stringify(this.formData));case 5:case"end":return t.stop()}},t,this)})),function(){return o.apply(this,arguments)})}),U=(n(405),n(19)),component=Object(U.a)(k,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"step3"}},[o("div",{staticClass:"top-step-bar"},[o("step-bar",{attrs:{steps:t.steps,progress:50}})],1),t._v(" "),o("div",{staticClass:"page-content"},[o("div",{staticClass:"title"},[o("div",{staticClass:"signup-title"},[t._v("上传视频")]),t._v(" "),o("div",{staticClass:"title-action",on:{click:t.gotoStep2}},[o("div",{staticClass:"title-action-text"},[t._v("查看题目")]),t._v(" "),o("img",{staticClass:"title-action-img",attrs:{src:n(251)}})])]),t._v(" "),o("div",[o("div",[o("div",{staticClass:"signup-title2"},[t._v("当前级别: "+t._s(t.landiLevel))]),t._v(" "),o("div",{staticClass:"topic-text"},[t.topic?o("div",{staticClass:"topic-text-eng"},[t._v(t._s(t.topic.en_topic_name))]):t._e(),t._v(" "),t.topic?o("div",{staticClass:"topic-text-chn"},[t._v(t._s(t.topic.cn_topic_name))]):t._e()]),t._v(" "),o("div",{staticClass:"video"},["uploaded"!=t.videoStatus.type?o("div",{staticClass:"video-hint"},["add"==t.videoStatus.type?o("img",{staticClass:"video-hint-hintimg",attrs:{src:n(394)}}):t._e(),t._v(" "),"error"==t.videoStatus.type?o("img",{staticClass:"video-hint-hintimg",attrs:{src:n(395)}}):t._e(),t._v(" "),t.videoStatus.hint?o("div",{staticClass:"video-hint-hint"},[t._v(t._s(t.videoStatus.hint))]):t._e(),t._v(" "),"uploading"==t.videoStatus.type?o("div",[o("div",{staticClass:"video-hint-progress"},[o("div",{staticClass:"video-hint-progress-bg"}),t._v(" "),o("div",{staticClass:"video-hint-progress-fg",style:{width:t.videoStatus.progress+"%"}})]),t._v(" "),o("div",{staticClass:"video-hint-progresstext"},[t._v("正在上传 "+t._s(t.videoStatus.progress)+"%")])]):t._e()]):t._e(),t._v(" "),"uploaded"==t.videoStatus.type?o("div",{staticClass:"video-uploaded"},[o("video",{staticClass:"video-uploaded-videoplay",staticStyle:{display:"none"},attrs:{id:"video-upload",controls:"",preload:"auto",src:t.videoSrc}}),t._v(" "),o("div",{staticClass:"video-uploaded-video",on:{click:function(e){return t.playFn("video-upload")}}},[o("img",{staticClass:"video-uploaded-video-img",attrs:{src:t.videoSrc+"?vframe/jpg/offset/2/h/960/"}}),t._v(" "),o("div",{staticClass:"video-uploaded-video-play"})])]):t._e(),t._v(" "),"uploading"!=t.videoStatus.type?o("div",{staticClass:"video-upload"},[o("label",{staticClass:"video-upload-action",attrs:{for:"video-upload-input"}},[o("img",{staticClass:"video-upload-action-img",attrs:{src:n(396)}})]),t._v(" "),o("input",{ref:"videoUploadInput",staticStyle:{display:"none"},attrs:{id:"video-upload-input",type:"file",accept:"video/*"},on:{change:t.videoUpload}})]):t._e()])]),t._v(" "),o("submit-area",{staticClass:"submitarea",attrs:{hint:"视频要求时长10-90秒, 视频小于300M",btnText:"进入下一步",isClickable:t.videoUploaded},on:{submit:t.nextStep}})],1)]),t._v(" "),o("toast",{ref:"toast"})],1)},[],!1,null,"5f385024",null);e.default=component.exports}}]);