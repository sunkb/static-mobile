(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{193:function(t,e,n){t.exports=n.p+"img/6446c2c.png"},195:function(t,e,n){"use strict";n.d(e,"a",function(){return r});n(108);function o(t){return t.webkitEnterFullScreen?"webkitEnterFullScreen":!!t.webkitRequestFullScreen&&"webkitRequestFullScreen"}var r=function(t){var video=t,e=document;/Android|webOS|iPhone|iPad|BlackBerry|iPod/i.test(navigator.userAgent)?(video.play(),"ipad"==navigator.userAgent.toLowerCase().match(/iPad/i)&&(video.addEventListener("play",function(){var t=o(video);video[t]()}),video.addEventListener("webkitfullscreenchange",function(t){e.webkitIsFullScreen||video.pause()},!1),video.addEventListener("fullscreenchange ",function(t){e.webkitIsFullScreen||video.pause()},!1),video.addEventListener("ended",function(){this.webkitExitFullScreen()},!1))):(video.requestFullscreen(),video.play(),video.addEventListener("play",function(){var t=o(video);video[t]()}),video.addEventListener("webkitfullscreenchange",function(t){e.webkitIsFullScreen||video.pause()},!1),video.addEventListener("fullscreenchange ",function(t){e.webkitIsFullScreen||video.pause()},!1),video.addEventListener("ended",function(){this.webkitExitFullScreen()},!1))}},249:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAUCAYAAAC07qxWAAAAAXNSR0IArs4c6QAAAYhJREFUKBWNkr9Lw1AQx5tflmxCXCKOzqLQqaBg0aRJGxxEEPwXBP8NFxcnERwcXBybtMYKtqJmCoKrkyjGwYBoCzahsX6vtCXRtnjwcpfv+7x79+69VKlU2k39w1iGYXYsyzrodDrsOJ6FqYA2AZ+4riuMghmaKJfL81EU2cjuSpK0kc1mv34v6IIk2rY9G4bhBcInnucNXdc/4/AAJLFarU4HQXCOMMDIG4bhk06WOICiKB62X4IeYlxXKpUZgsgSIAnFYvEdbgUHfETdN1QS6YmtSegbdcDzvGP85wRBUEaCtIB6i7btw2/92bqfkTzq/YZ7gZ/g4hPxGFmYTCazB7+NdmlDt67Vanyz2TwClEc2BW265+NZKHYcR/R9/xTAHMdxi4VC4YH0REZkmmw0Ghb0qXQ6vaqq6jNBZIMa0S+51WpdkoaacpqmvXaJ3qd76t4930L7EEVxGff8FocoZnBNC+12+ww13eHlrA97OQSyuKY6/JUsy2ujIAJTpmkeog1jG0/cD4cAmT4DCe2kAAAAAElFTkSuQmCC"},250:function(t,e,n){var content=n(391);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(39).default)("5165b8c6",content,!0,{sourceMap:!1})},379:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAAXNSR0IArs4c6QAAAg9JREFUaAXtmr9OwlAUh9sig5PECBOTK0vZ3E3cXFzcXVzgAZx1Y8T4ACaGwTi4GF9AWfgTBt7AwahxYIFE2vo7CSTkpDRV7K2cni69p5R77ne+0yaXYHe73WPLsppBEBRxTup4yeVytWq1ep9UgrjzOgC9TBiW1lL2PK/V7/fduAtL6j4HE+8kNTmbdxPQd4AusOtGQwI2eez6vn+NjrJNJl3MZRrYAuxhr9c7W1yEybFx4BncOaD3TYLOc6UCDMv0smwNBoPyfCGmzqkAExyAi9Pp9LbT6eRNwVKe1IApOaD3bNtu0tjUYaPCgalkEXkeAP6MAvgR96z0Eeb/wPw3/wV4JZi4Xwb0Y6otHXehf3jfQaaA0dJOpoCpUzIHvLHs+cAD/uY4zpHrum2ME3t7Lsv/2+vD4XB7Mpk00L4nYXNEGb7C/vVpnWAJsFKpfJZKpRqGXz8FNrVtDFvXStdGo9EWRIV2b+hFyoaWOMWvIa8YttHaa9PS2HMXxuMx7cZCt6BLgfGFPKAvcLYwCZ1EHFHPsAhADqHAvCLSYjUszSjnUcO8ItJiNSzNKOdRw7wi0mI1LM0o51HDvCLSYjUszSjnUcO8ItJiNSzNKOdRw7wi0mI1LM0o51HDvCLSYjUszSjnUcO8ItJiNSzNKOdRw7wi0mI1LM0o58meYfyB651XQWpMrGS4ngXoGWP9G0Vnh6+nvMDOAAAAAElFTkSuQmCC"},380:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAAXNSR0IArs4c6QAAAnZJREFUaAXtmr1KA0EUhbO7WNhZaGU605sEBUtRsLOWvIPptfURxCcQJIVY2IhNwMpq89dbaqWPkOx6D7gwhCRuZu7cGdhZCDvozrnnu2fcnZhEg8HgIs/zu1qttk0vW8dnkiSXrVbr2VaBsrqxACy81GezWW84HO6XNWbrupiEbSar+t7MsuxpNBptqT+UHgNY8tgj6HtaVZFkUbWWNHCNYM9paV+rJiTH4sCAI+gbgj6VBC1qOQGm4glB9yaTSb0wInV2BYyUd6bT6WOaphtSsKjjDBjFCfqITrcYSx0RdTiXKraizksURe/UgGzFNUa/Iv0f0n/wBdgIpuxkgn51uqTLGmW87qxSwLSk40oBY6UEYMa/Fy+lQsJexsJoKiTM2EwvpULCXsbCaCokzNhML6VCwiaxxHF8Ra9Dehv2YaKDudCAFjRNtdT53An32+12Sp8yHJtAYy40oEVm+6ph0zErML396o3H491ms/mlC13AQgNa0DSFVOdzAzfoI5U3Xeh5WGgRcEM1bDpmBYYZGNSBloCFP3ZgHWgpWGvA60BLwloFLgMtDWsdeBW0C1gR4GXQeGwVjx4bd2PUXXSI/iNeTRVm8PiShEVNK3dpCPt6iAGr6SJZ3c2JaSNFgOdhsYx1NiemsJhvHXgRLHZjujsyU2irwMtgC9MuoK0B/wfrCtoKcFlYF9DswOvCSkOzAuvCSkJzA3dMt4vzNzJqYqdoCMeZFZjMntAXzg5Mt4sFNLQIkvULbKJ7aY6ETDVYEzY1IzE/AEt02WWNkLDL7kvUDglLdNlljZCwy+5L1K5ewrQ5/5borA81wIqEu1WA/mPs/gJ/XAadc7UYlQAAAABJRU5ErkJggg=="},381:function(t,e,n){t.exports=n.p+"img/88250a2.png"},390:function(t,e,n){"use strict";var o=n(250);n.n(o).a},391:function(t,e,n){e=t.exports=n(38)(!1);var o=n(180)(n(193));e.push([t.i,".top-step-bar[data-v-6cebbfac] {\n  padding-top: 0.4rem;\n  margin-bottom: 0.4rem;\n  height: 2.2rem;\n}\n.page-content[data-v-6cebbfac] {\n  padding: 0 0.4rem;\n}\nh1[data-v-6cebbfac] {\n  font-size: 0.4rem;\n  font-weight: bold;\n  color: #333333;\n  padding: 0.3rem 0;\n}\nh2[data-v-6cebbfac] {\n  font-size: 0.373333rem;\n  color: #333333;\n  padding: 0.2rem 0;\n}\nh3[data-v-6cebbfac] {\n  font-size: 0.346667rem;\n  color: #B2B2B2;\n  padding: 0.1rem 0;\n}\np[data-v-6cebbfac] {\n  font-size: 0.346667rem;\n  color: #808080;\n}\n#step3[data-v-6cebbfac] {\n  width: 100vw;\n  height: 100vh;\n  background: #fff;\n}\n.title[data-v-6cebbfac] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding-right: 0.3rem;\n}\n.title-action h3[data-v-6cebbfac] {\n  color: #16C8D2;\n  display: inline-block;\n}\n.title-action-img[data-v-6cebbfac] {\n  width: 0.133333rem;\n}\n.topic-text[data-v-6cebbfac] {\n  margin-top: -0.1rem;\n  width: 9rem;\n}\n.topic-text-eng[data-v-6cebbfac] {\n  font-weight: bold;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n.topic-text-chn[data-v-6cebbfac] {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  margin-top: -0.066667rem;\n}\n.video[data-v-6cebbfac] {\n  text-align: center;\n  margin-top: 0.3rem;\n  display: flex;\n  justify-content: center;\n  position: relative;\n}\n.video-hint[data-v-6cebbfac] {\n  width: 8.533333rem;\n  height: 4.8rem;\n  display: flex;\n  flex-flow: column;\n  justify-content: center;\n  align-items: center;\n  background: #FAFAFA;\n  border: 0.02rem dashed #E6E6E6;\n}\n.video-hint-hint[data-v-6cebbfac] {\n  width: 2.6rem;\n  color: #B2B2B2;\n  font-size: 0.32rem;\n  margin-top: 0.2rem;\n}\n.video-hint-hintimg[data-v-6cebbfac] {\n  width: 0.8rem;\n  height: 0.8rem;\n}\n.video-hint-progress[data-v-6cebbfac] {\n  position: relative;\n  width: 4.666667rem;\n  height: 0.133333rem;\n  margin-bottom: 0.3rem;\n}\n.video-hint-progress-bg[data-v-6cebbfac] {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: #E6E6E6;\n  border-radius: 0.1rem;\n}\n.video-hint-progress-fg[data-v-6cebbfac] {\n  position: absolute;\n  top: 0;\n  left: 0;\n  height: 100%;\n  background: #16C8D2;\n  border-radius: 0.1rem;\n}\n.video-uploaded-video[data-v-6cebbfac] {\n  width: 8.533333rem;\n  height: 4.8rem;\n  overflow: hidden;\n  position: relative;\n  background: #E6E6E6;\n}\n.video-uploaded-video-play[data-v-6cebbfac] {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  width: 1.333333rem;\n  height: 1.333333rem;\n  background: url("+o+") 50% 50%/contain no-repeat;\n}\n.video-upload[data-v-6cebbfac] {\n  position: absolute;\n  left: 50%;\n  bottom: 0;\n  transform: translate(-50%, 50%);\n}\n.video-upload-action[data-v-6cebbfac] {\n  width: 1.2rem;\n  height: 1.2rem;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background: #fff;\n  border-radius: 0.6rem;\n  box-shadow: 0 0 0.5rem -0.3rem #666666;\n}\n.video-upload-action-img[data-v-6cebbfac] {\n  width: 0.86rem;\n  height: 0.86rem;\n}",""])},404:function(t,e,n){"use strict";n.r(e);n(75),n(60),n(23),n(24),n(42),n(40);var o,r,d,c=n(5),l=n(201),v=n(188),h=(n(382),n(112),n(113),n(13),n(59),n(209)),f=n(210),m=n(181),A=n(389),S={video:{mimeType:["video/mp4","video/mpeg","video/quicktime","video/x-msvideo","video/ogg","video/webm","application/vnd.rn-realmedia-vbr"],limit:300}},w="video",E=function(){function t(){Object(h.a)(this,t)}var e;return Object(f.a)(t,[{key:"init",value:(e=Object(c.a)(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.a.get("/Mobile/StudentActivity/token");case 2:(e=t.sent).status&&(this.domain=e.data.domain,this.token=e.data.uptoken);case 4:case"end":return t.stop()}},t,this)})),function(){return e.apply(this,arguments)})},{key:"upload",value:function(t,e,n,o,r){var d=30,c={};if(e&&S[e]&&(d=S[e].limit,c.mimeType=S[e].mimeType),t.size>1024*d*1024)return{error:"上传文件不能大于".concat(d,"MB")};var l=t.name.split("."),v="".concat(C(),".").concat(l[l.length-1]),h=A.upload(t,v,this.token,c);return h.subscribe({next:n,error:o,complete:r}),{subscription:h}}}]),t}(),C=function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(t){return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)})},y=n(192),x=n(190),k=n(195),_={name:"Signup",mixins:[x.default],head:function(){return{title:"上传视频"}},components:{"step-bar":l.b,"submit-area":l.c,toast:y.a},data:function(){return{steps:v.STEPS,landiLevel:"",topic:null,videoStatus:{},videoSrc:"",formData:null}},computed:{videoUploaded:function(){return"uploaded"==this.videoStatus.type}},methods:{nextStep:function(){this.videoUploaded&&this.gotoPage("presentation-signup-step4")},gotoStep2:function(){this.gotoPage("presentation-signup-step2")},videoUpload:(d=Object(c.a)(regeneratorRuntime.mark(function t(){var e,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.$refs.toast.showLoadingToast(),e=new E,t.next=4,e.init();case 4:this.videoStatus=v.VIDEO_STATUS_TYPE.UPLOADING,this.videoSrc=e.domain,n=e.upload(this.$refs.videoUploadInput.files[0],w,this.fileUploadNext,this.fileUploadError,this.fileUploadComplete),this.$refs.toast.hideLoadingToast(),n.error&&this.$refs.toast.showToast(n.error);case 9:case"end":return t.stop()}},t,this)})),function(){return d.apply(this,arguments)}),fileUploadNext:function(t){this.videoStatus.progress=Math.round(100*t.total.percent)/100},fileUploadError:function(t){console.log(t),this.videoStatus=v.VIDEO_STATUS_TYPE.ERROR,this.$refs.toast.showToast(t.message)},fileUploadComplete:function(t){this.videoStatus=v.VIDEO_STATUS_TYPE.UPLOADED,this.videoSrc="".concat(this.videoSrc).concat(t.key),this.formData.videoSrc=this.videoSrc,this.formData.videoKey=t.key,localStorage.setItem(v.STROGE.FORM_DATA,JSON.stringify(this.formData)),this.$refs.toast.showToast("上传成功")},initDataFromStroge:function(){var t=JSON.parse(localStorage.getItem(v.STROGE.FORM_DATA));if(!(t&&t.landiLevel&&t.landiLevel.topics))return!1;this.landiLevel=t.landiLevel.name;var e=!0,n=!1,o=void 0;try{for(var r,d=t.landiLevel.topics[Symbol.iterator]();!(e=(r=d.next()).done);e=!0){var c=r.value;c.id==t.topicID&&(this.topic=c)}}catch(t){n=!0,o=t}finally{try{e||null==d.return||d.return()}finally{if(n)throw o}}return t.videoSrc?(this.videoSrc=t.videoSrc,this.videoStatus=v.VIDEO_STATUS_TYPE.UPLOADED):this.videoStatus=v.VIDEO_STATUS_TYPE.ADD,this.formData=t,!0},initDataFromAPI:(r=Object(c.a)(regeneratorRuntime.mark(function t(){var e,n,video,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.$refs.toast.showLoadingToast(),e=this.$route.query.activity_id,t.next=4,m.a.get("".concat(v.API.MY_WORK,"?activity_id=").concat(e));case 4:if(n=t.sent,this.$refs.toast.hideLoadingToast(),n.status){t.next=11;break}return this.$refs.toast.showToast(n.info),t.abrupt("return",!1);case 11:if(!n.data.id){t.next=22;break}return this.landiLevel=n.data.combination_name,this.topic={cn_topic_name:n.data.cn_topic_name,en_topic_name:n.data.en_topic_name},this.videoSrc=n.data.video_url,this.videoStatus=v.VIDEO_STATUS_TYPE.UPLOADED,video=n.data.video_url.split("/"),o=video[video.length-1],this.formData={landiLevel:{id:n.data.combination_id},topicID:n.data.topic_id,videoKey:o,workID:n.data.id,address:n.data.address},t.abrupt("return",!0);case 22:return t.abrupt("return",!1);case 23:case"end":return t.stop()}},t,this)})),function(){return r.apply(this,arguments)}),playFn:function(t){var e=document.getElementById(t);Object(k.a)(e)}},mounted:(o=Object(c.a)(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.initDataFromStroge()){t.next=4;break}return t.next=4,this.initDataFromAPI();case 4:localStorage.setItem(v.STROGE.FORM_DATA,JSON.stringify(this.formData));case 5:case"end":return t.stop()}},t,this)})),function(){return o.apply(this,arguments)})},U=(n(390),n(19)),component=Object(U.a)(_,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"step3"}},[o("div",{staticClass:"top-step-bar"},[o("step-bar",{attrs:{steps:t.steps,progress:50}})],1),t._v(" "),o("div",{staticClass:"page-content"},[o("div",{staticClass:"title"},[o("h1",[t._v("上传视频")]),t._v(" "),o("div",{staticClass:"title-action",on:{click:t.gotoStep2}},[o("h3",[t._v("查看题目")]),t._v(" "),o("img",{staticClass:"title-action-img",attrs:{src:n(249)}})])]),t._v(" "),o("h2",[t._v("当前级别: "+t._s(t.landiLevel))]),t._v(" "),o("div",{staticClass:"topic-text"},[t.topic?o("h2",{staticClass:"topic-text-eng"},[t._v(t._s(t.topic.en_topic_name))]):t._e(),t._v(" "),t.topic?o("h3",{staticClass:"topic-text-chn"},[t._v(t._s(t.topic.cn_topic_name))]):t._e()]),t._v(" "),o("div",{staticClass:"video"},["uploaded"!=t.videoStatus.type?o("div",{staticClass:"video-hint"},["add"==t.videoStatus.type?o("img",{staticClass:"video-hint-hintimg",attrs:{src:n(379)}}):t._e(),t._v(" "),"error"==t.videoStatus.type?o("img",{staticClass:"video-hint-hintimg",attrs:{src:n(380)}}):t._e(),t._v(" "),t.videoStatus.hint?o("div",{staticClass:"video-hint-hint"},[t._v(t._s(t.videoStatus.hint))]):t._e(),t._v(" "),"uploading"==t.videoStatus.type?o("div",[o("div",{staticClass:"video-hint-progress"},[o("div",{staticClass:"video-hint-progress-bg"}),t._v(" "),o("div",{staticClass:"video-hint-progress-fg",style:{width:t.videoStatus.progress+"%"}})]),t._v(" "),o("h3",[t._v("正在上传 "+t._s(t.videoStatus.progress)+"%")])]):t._e()]):t._e(),t._v(" "),"uploaded"==t.videoStatus.type?o("div",{staticClass:"video-uploaded"},[o("video",{staticClass:"video-uploaded-videoplay",staticStyle:{display:"none"},attrs:{id:"video-upload",controls:"",preload:"auto",src:t.videoSrc}}),t._v(" "),o("div",{staticClass:"video-uploaded-video",on:{click:function(e){return t.playFn("video-upload")}}},[o("div",{staticClass:"video-uploaded-video-play"})])]):t._e(),t._v(" "),"uploading"!=t.videoStatus.type?o("div",{staticClass:"video-upload"},[o("label",{staticClass:"video-upload-action",attrs:{for:"video-upload-input"}},[o("img",{staticClass:"video-upload-action-img",attrs:{src:n(381)}})]),t._v(" "),o("input",{ref:"videoUploadInput",staticStyle:{display:"none"},attrs:{id:"video-upload-input",type:"file",accept:"video/*"},on:{change:t.videoUpload}})]):t._e()])]),t._v(" "),o("submit-area",{attrs:{hint:"视频要求时长10-90秒, 视频小于300M",btnText:"进入下一步",isClickable:t.videoUploaded},on:{submit:t.nextStep}}),t._v(" "),o("toast",{ref:"toast"})],1)},[],!1,null,"6cebbfac",null);e.default=component.exports}}]);